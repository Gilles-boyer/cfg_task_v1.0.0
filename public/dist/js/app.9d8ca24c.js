(function(e){function t(t){for(var i,n,s=t[0],l=t[1],d=t[2],c=0,u=[];c<s.length;c++)n=s[c],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&u.push(o[n][0]),o[n]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);m&&m(t);while(u.length)u.shift()();return r.push.apply(r,d||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],i=!0,n=1;n<a.length;n++){var s=a[n];0!==o[s]&&(i=!1)}i&&(r.splice(t--,1),e=l(l.s=a[0]))}return e}var i={},n={app:0},o={app:0},r=[];function s(e){return l.p+"js/"+({}[e]||e)+"."+{"chunk-09c913b5":"fd74f5c2","chunk-41222ae4":"056f1578","chunk-da9ac9ac":"747b7449"}[e]+".js"}function l(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(e){var t=[],a={"chunk-41222ae4":1,"chunk-da9ac9ac":1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=new Promise((function(t,a){for(var i="css/"+({}[e]||e)+"."+{"chunk-09c913b5":"31d6cfe0","chunk-41222ae4":"df9d9a7c","chunk-da9ac9ac":"ff4c7568"}[e]+".css",o=l.p+i,r=document.getElementsByTagName("link"),s=0;s<r.length;s++){var d=r[s],c=d.getAttribute("data-href")||d.getAttribute("href");if("stylesheet"===d.rel&&(c===i||c===o))return t()}var u=document.getElementsByTagName("style");for(s=0;s<u.length;s++){d=u[s],c=d.getAttribute("data-href");if(c===i||c===o)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var i=t&&t.target&&t.target.src||o,r=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=i,delete n[e],m.parentNode.removeChild(m),a(r)},m.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(m)})).then((function(){n[e]=0})));var i=o[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise((function(t,a){i=o[e]=[t,a]}));t.push(i[2]=r);var d,c=document.createElement("script");c.charset="utf-8",c.timeout=120,l.nc&&c.setAttribute("nonce",l.nc),c.src=s(e);var u=new Error;d=function(t){c.onerror=c.onload=null,clearTimeout(m);var a=o[e];if(0!==a){if(a){var i=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+n+")",u.name="ChunkLoadError",u.type=i,u.request=n,a[1](u)}o[e]=void 0}};var m=setTimeout((function(){d({type:"timeout",target:c})}),12e4);c.onerror=c.onload=d,document.head.appendChild(c)}return Promise.all(t)},l.m=e,l.c=i,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(a,i,function(t){return e[t]}.bind(null,i));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var d=window["webpackJsonp"]=window["webpackJsonp"]||[],c=d.push.bind(d);d.push=t,d=d.slice();for(var u=0;u<d.length;u++)t(d[u]);var m=c;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);var i=a("2b0e"),n=a("bc3a"),o=a.n(n);let r={};const s=o.a.create(r);s.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),s.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)})),Plugin.install=function(e,t){e.axios=s,window.axios=s,Object.defineProperties(e.prototype,{axios:{get(){return s}},$axios:{get(){return s}}})},i["a"].use(Plugin);Plugin;var l=a("7496"),d=a("40dc"),c=a("8336"),u=a("132d"),m=a("adda"),f=a("f6c4"),p=a("2fa4"),h=function(){var e=this,t=e._self._c;return t(l["a"],[t(d["a"],{attrs:{app:"",color:"primary",dark:""}},[t("div",{staticClass:"d-flex align-center"},[t(m["a"],{staticClass:"shrink mr-2",attrs:{alt:"Vuetify Logo",contain:"",src:a("cf05"),transition:"scale-transition",width:"40"}})],1),t(p["a"]),t(c["a"],{attrs:{href:"https://www.cfg.re",target:"_blank",text:""}},[t("span",{staticClass:"mr-2"},[e._v("Circuit Felix Guichard")]),t(u["a"],[e._v("mdi-go-kart-track")])],1)],1),t(f["a"],[t("router-view")],1)],1)},g=[],v={name:"App",data:()=>({})},b=v,x=a("2877"),I=Object(x["a"])(b,h,g,!1,null,null,null),y=I.exports,k=a("8c4f"),_=a("b0af"),P=a("99d9"),w=a("cc20"),S=a("62ad"),O=a("a523"),C=a("8fea"),D=a("2e4b"),j=a("169a"),R=a("ce7e"),T=a("e449"),A=a("0fd9"),$=a("b974"),N=a("8654"),E=a("71d9"),F=a("2a7f"),L=function(){var e=this,t=e._self._c;return t(C["a"],{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.resas,"sort-by":"dateRoulage","show-expand":""},scopedSlots:e._u([{key:"top",fn:function(){return[t(E["a"],{attrs:{flat:""}},[t(F["a"],[e._v("Suivi Date Rallye")]),t(R["a"],{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t(p["a"]),t(j["a"],{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:i}){return[t(c["a"],e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",i,!1),a),[e._v(" New Date ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(_["a"],[t(P["d"],[t("span",{staticClass:"text-h5"},[e._v(e._s(e.formTitle))])]),t(P["c"],[t(O["a"],[t(A["a"],[t(S["a"],{attrs:{cols:"12"}},[t(T["a"],{ref:"menu",attrs:{"close-on-content-click":!1,"return-value":e.editedItem.dateRoulage,transition:"scale-transition","offset-y":"","min-width":"auto"},on:{"update:returnValue":function(t){return e.$set(e.editedItem,"dateRoulage",t)},"update:return-value":function(t){return e.$set(e.editedItem,"dateRoulage",t)}},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:i}){return[t(N["a"],e._g(e._b({attrs:{label:"Choisir une date","prepend-icon":"mdi-calendar",readonly:""},model:{value:e.editedItem.dateRoulage,callback:function(t){e.$set(e.editedItem,"dateRoulage",t)},expression:"editedItem.dateRoulage"}},"v-text-field",i,!1),a))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[t(D["a"],{attrs:{"no-title":"",scrollable:""},model:{value:e.editedItem.dateRoulage,callback:function(t){e.$set(e.editedItem,"dateRoulage",t)},expression:"editedItem.dateRoulage"}},[t(p["a"]),t(c["a"],{attrs:{text:"",color:"primary"},on:{click:function(t){e.menu=!1}}},[e._v(" Cancel ")]),t(c["a"],{attrs:{text:"",color:"primary"},on:{click:function(t){return e.$refs.menu.save(e.editedItem.dateRoulage)}}},[e._v(" OK ")])],1)],1)],1),t(S["a"],{attrs:{cols:"12"}},[t($["a"],{attrs:{items:e.momentTab,label:"Selectionner un moment"},model:{value:e.editedItem.matinOuSoir,callback:function(t){e.$set(e.editedItem,"matinOuSoir",t)},expression:"editedItem.matinOuSoir"}})],1),t(S["a"],{attrs:{cols:"12"}},[t(N["a"],{attrs:{label:"Nbr Pilote"},model:{value:e.editedItem.nbrPilote,callback:function(t){e.$set(e.editedItem,"nbrPilote",t)},expression:"editedItem.nbrPilote"}})],1)],1)],1)],1),t(P["a"],[t(p["a"]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(" Cancel ")]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v(" Save ")])],1)],1)],1),t(j["a"],{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[t(_["a"],[t(P["d"],{staticClass:"text-h5"},[e._v("Are you sure you want to delete this item?")]),t(P["a"],[t(p["a"]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancel")]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("OK")]),t(p["a"])],1)],1)],1)],1)]},proxy:!0},{key:"expanded-item",fn:function({headers:e,item:a}){return[t("td",{attrs:{colspan:e.length}},[t("Pilote",{attrs:{pilotes:a}})],1)]}},{key:"item.actions",fn:function({item:a}){return[t(u["a"],{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),t(u["a"],{attrs:{small:""},on:{click:function(t){return e.deleteItem(a)}}},[e._v(" mdi-delete ")])]}},{key:"item.dateRoulage",fn:function({item:t}){return[e._v(" "+e._s(e.changeViewDate(t.dateRoulage))+" ")]}},{key:"item.matinOuSoir",fn:function({item:a}){return[t(w["a"],{attrs:{color:e.getColor(a.matinOuSoir),dark:""}},[e._v(" "+e._s(a.matinOuSoir)+" ")])]}},{key:"item.Pilotes",fn:function({item:t}){return[e._v(" "+e._s(t.Pilotes.length)+" ")]}},{key:"no-data",fn:function(){return[t(c["a"],{attrs:{color:"primary"},on:{click:e.initialize}},[e._v(" Reset ")])]},proxy:!0}])})},M=[],q=a("7424"),V={getResa(){return q["a"].get("/rally")},createResa(e){return q["a"].post("/rally/store/resa",e)},updateResa(e){return q["a"].post("/rally/update/resa",e)},deleteResa(e){return q["a"].get("/rally/delete/resa/"+e)},addPilote(e){return q["a"].post("/rally/store/pilote",e)},updatePilote(e){return q["a"].post("/rally/update/pilote/admin",e)},deletePilote(e){return q["a"].get("/rally/delete/pilote/"+e)},reduceSessionPilote(e){return q["a"].get("/rally/update/session/pilote/"+e)}},z=a("b73d"),B=function(){var e=this,t=e._self._c;return t(C["a"],{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.pilotes.Pilotes},scopedSlots:e._u([{key:"top",fn:function(){return[t(E["a"],{attrs:{flat:""}},[t(F["a"],[e._v("Liste des pilotes")]),t(R["a"],{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),t(p["a"]),t(j["a"],{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function({on:a,attrs:i}){return[t(c["a"],e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",i,!1),a),[e._v(" New pilote ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[t(_["a"],[t(P["d"],[t("span",{staticClass:"text-h5"},[e._v(e._s(e.formTitle))]),t(p["a"]),t(z["a"],{attrs:{label:"Paiement: "+e.editedItem.paiement.toString()},model:{value:e.editedItem.paiement,callback:function(t){e.$set(e.editedItem,"paiement",t)},expression:"editedItem.paiement"}})],1),t(P["c"],[t(O["a"],[t(A["a"],[t(S["a"],{attrs:{cols:"12"}},[t(N["a"],{attrs:{label:"Nom Prénom"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}})],1),t(S["a"],{attrs:{cols:"12"}},[t(N["a"],{attrs:{label:"Voiture"},model:{value:e.editedItem.voiture,callback:function(t){e.$set(e.editedItem,"voiture",t)},expression:"editedItem.voiture"}})],1),t(S["a"],{attrs:{cols:"12"}},[t($["a"],{attrs:{items:e.formules,label:"Formule"},on:{change:function(t){return e.changeFormule()}},model:{value:e.editedItem.formule,callback:function(t){e.$set(e.editedItem,"formule",t)},expression:"editedItem.formule"}})],1),t(S["a"],{attrs:{cols:"12"}},[t(N["a"],{attrs:{label:"Tel"},model:{value:e.editedItem.phone,callback:function(t){e.$set(e.editedItem,"phone",t)},expression:"editedItem.phone"}})],1)],1)],1)],1),t(P["a"],[t(p["a"]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(" Cancel ")]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.save}},[e._v(" Save ")])],1)],1)],1),t(j["a"],{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[t(_["a"],[t(P["d"],{staticClass:"text-h5"},[e._v("Are you sure you want to delete this item?")]),t(P["a"],[t(p["a"]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancel")]),t(c["a"],{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("OK")]),t(p["a"])],1)],1)],1)],1)]},proxy:!0},{key:"item.actions",fn:function({item:a}){return[a.nbrSession>0?t(c["a"],{staticClass:"mr-2",attrs:{color:"primary"},on:{click:function(t){return e.countSession(a)}}},[e._v("-1 session ")]):e._e(),t(u["a"],{staticClass:"mr-2",on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),t(u["a"],{on:{click:function(t){return e.deleteItem(a)}}},[e._v(" mdi-delete ")])]}},{key:"item.nbrSession",fn:function({item:a}){return[t(w["a"],{attrs:{color:e.getColorNbrSession(a.nbrSession),dark:""}},[e._v(" "+e._s(a.nbrSession)+" ")])]}},{key:"item.paiement",fn:function({item:a}){return[t(w["a"],{attrs:{color:e.getColorPaiement(a.paiement),dark:""}},[e._v(" "+e._s(a.paiement)+" ")])]}}])})},J=[],K={data:()=>({dialog:!1,dialogDelete:!1,headers:[{text:"Résa N°",align:"start",sortable:!1,value:"id"},{text:"Nom pilote",value:"name"},{text:"Voiture",value:"voiture"},{text:"Formule",value:"formule"},{text:"Contact",value:"phone"},{text:"Nbr Session",value:"nbrSession"},{text:"Paiement",value:"paiement"},{text:"Actions",value:"actions",sortable:!1}],editedIndex:-1,editedItem:{name:"",voiture:"",formule:"",phone:"",nbrSession:0,paiement:!1,rally:""},defaultItem:{name:"",voiture:"",formule:"",phone:"",nbrSession:0,paiement:!1,rally:""},formules:["1 session 10min => 25€","3 sessions 10min => 60€","1/2 journée => 180€","1 journée => 250€"]}),props:["pilotes"],computed:{formTitle(){return-1===this.editedIndex?"Ajout d'un Pilote":"Modifier un Pilote"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()}},methods:{async countSession(e){this.pilotes.Pilotes[this.pilotes.Pilotes.indexOf(e)].nbrSession--;var t=await V.reduceSessionPilote(e.id);console.log(t)},getPaiement(e){return e?"payé":"non payé"},getColorPaiement(e){return e?"green":"error"},getColorNbrSession(e){return 1==e?"accent":e<=0?"error":"green"},initRally(){this.editedItem.rally=this.pilotes.id},changeFormule(){"1 session 10min => 25€"==this.editedItem.formule?this.editedItem.nbrSession=1:"3 sessions 10min => 60€"==this.editedItem.formule?this.editedItem.nbrSession=3:this.editedItem.nbrSession=99},editItem(e){this.editedIndex=this.pilotes.Pilotes.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem(e){this.editedIndex=this.pilotes.Pilotes.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},async deleteItemConfirm(){var e=await V.deletePilote(this.editedItem.id);console.log(e),this.pilotes.Pilotes.splice(this.editedIndex,1),this.closeDelete()},close(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},async save(){if(this.editedIndex>-1){var e=await V.updatePilote(this.editedItem);Object.assign(this.pilotes.Pilotes[this.editedIndex],this.editedItem)}else{this.initRally();e=await V.addPilote(this.editedItem);this.pilotes.Pilotes.push(e.data)}console.log(e),this.close()}}},H=K,U=Object(x["a"])(H,B,J,!1,null,null,null),G=U.exports,Q={components:{Pilote:G},data:()=>({date:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),menu:!1,modal:!1,menu2:!1,momentTab:["matin","aprem"],dialog:!1,dialogDelete:!1,headers:[{text:"Id Journée",align:"start",sortable:!1,value:"id"},{text:"Date Roulage",value:"dateRoulage"},{text:"Moment",value:"matinOuSoir"},{text:"Nbr Pilote Max",value:"nbrPilote"},{text:"Nbr Pilote Inscrit",value:"Pilotes"},{text:"Actions",value:"actions",sortable:!1}],resas:[],editedIndex:-1,editedItem:{_id:"",dateRoulage:"",matinOuSoir:"",nbrPilote:0,Pilotes:[],id:""},defaultItem:{_id:"",dateRoulage:new Date(Date.now()-6e4*(new Date).getTimezoneOffset()).toISOString().substr(0,10),matinOuSoir:"",nbrPilote:0,Pilotes:[],id:""}}),computed:{formTitle(){return-1===this.editedIndex?"Création Date Roulage":"Modification résa"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()}},created(){this.initialize()},methods:{getColor(e){return"matin"==e?"second":"accent"},changeViewDate(e){e=new Date(e);var t=new Array("Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi");return t[e.getDay()]+"-"+e.toLocaleDateString("fr")},initialize(){fetch("https://mytaskcfg.herokuapp.com/api/rally").then(e=>e.json()).then(e=>{this.resas=e}).catch(e=>alert("Erreur : "+e))},editItem(e){this.editedIndex=this.resas.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},deleteItem(e){this.editedIndex=this.resas.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},async deleteItemConfirm(){var e=await V.deleteResa(this.editedItem.id);console.log(e),this.resas.splice(this.editedIndex,1),this.closeDelete()},close(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},async save(){var e={date:this.editedItem.dateRoulage,moment:this.editedItem.matinOuSoir,nbrPilote:this.editedItem.nbrPilote};if(this.editedIndex>-1){e.id=this.editedItem.id;var t=await V.updateResa(e);console.log(t),Object.assign(this.resas[this.editedIndex],this.editedItem)}else{t=await V.createResa(e);t.data.Pilotes=[],this.resas.push(t.data)}this.close()}}},W=Q,X=Object(x["a"])(W,L,M,!1,null,null,null),Y=X.exports,Z=a("2f62");i["a"].use(Z["a"]);var ee=new Z["a"].Store({state:{login:!1,user:""},mutations:{},actions:{},modules:{}});i["a"].use(k["a"]);const te=[{path:"/rallye/admin",name:"Home",component:Y,meta:{requiresAuth:!0}},{path:"/",name:"Login",component:()=>a.e("chunk-41222ae4").then(a.bind(null,"a55b"))},{path:"/caisse",name:"Caisse",component:()=>a.e("chunk-da9ac9ac").then(a.bind(null,"350b")),meta:{requiresAuth:!0}},{path:"/pdfcaisse/:id",name:"Pdf",component:()=>a.e("chunk-09c913b5").then(a.bind(null,"e05d")),meta:{requiresAuth:!0}}],ae=new k["a"]({routes:te});ae.beforeEach((e,t,a)=>{if(e.matched.some(e=>e.meta.requiresAuth)){if(ee.state.login)return void a();a("/")}else a()});var ie=ae,ne=a("f309");i["a"].use(ne["a"]);var oe=new ne["a"]({theme:{themes:{light:{primary:"#04153B",secondary:"#A09F9F",accent:"#FD801F",error:"#FE001A"}}}});i["a"].config.productionTip=!1,new i["a"]({router:ie,store:ee,vuetify:oe,render:e=>e(y)}).$mount("#app")},7424:function(e,t,a){"use strict";var i=a("bc3a"),n=a.n(i);t["a"]=n.a.create({baseURL:"api",headers:{"Content-Type":"application/json",Accept:"application/json"}})},cf05:function(e,t,a){e.exports=a.p+"img/logo.4f1c962d.png"}});
//# sourceMappingURL=app.9d8ca24c.js.map